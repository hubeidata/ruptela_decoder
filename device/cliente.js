const net = require('net');

// Configura host y puerto
const options = { port: 6000 };

console.log(`[${new Date().toISOString()}] Iniciando conexión a ${options.host}:${options.port}`);

const client = net.connect(options, () => {
  console.log(`[${new Date().toISOString()}] Conectado al servidor`);

  // Datos en hexadecimal
  const hexString = '03FC000315A07F440B1D0B00012020202020202020202020202020202020002020202020202020202020202020202020202020202020202020202020202020202020021553565420303620203030313620303030FFFFFFFF5139D511000000005139D5890000001501414243313233202020202020205139D3FE000008200002CD22D302D422D502D922DBA000030215535654203036202030303136203030305139D3810115000000000215535654203036202030303136203030305139D3FE0115000000000215535654203036202030303136203030305139D58801150000000000005A7CD46454F96FFD17185048208D996974A02AE71782B64DF19925DAE60402F648D2F9AE456D9409BE733A3D695A16DE44D6B9FEDE9AB7FCD87BAC382D28594E7394E0544109DBF57ADF57586EBF4AD9209BB33CEC61F75C8247498049ED6320A84525926A1FEFAB9237CC81EC1978167FDEBFF9CAD05419BE5F6587F37D56A776025147AA7F0000080004014D75737465726672617520343320202020202020202020202020202020202020202020014B7269737461203433202020202020202020202020202020202020202020202020202001123331303030303030303631333030303063D5B7005147172800000000514717B100000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00014D75737465726672617520343320202020202020202020202020202020202020202020014B7269737461203433202020202020202020202020202020202020202020202020202001123331303030303030303631333030303063D5B700514718630000000051471904000002150141424331323320202020202020514717B000014D75737465726672617520343320202020202020202020202020202020202020202020014B7269737461203433202020202020202020202020202020202020202020202020202001123331303030303030303631333030303063D5B70051472A6F0000020051472B610000021501414243313233202020202020205147190300014D75737465726672617520343320202020202020202020202020202020202020202020014B7269737461203433202020202020202020202020202020202020202020202020202001123331303030303030303631333030303063D5B70051473D3C0000020051473EFB00000815014142433132332020202020202051472B600000142000032B232D03301B312333037D1B80238103CD1BCE03D123D5A000AB31A333AB80A381ABCEA3D1030112333130303030303030363133303030305147190301150000000201123331303030303030303631333030303051472B6001150000000201123331303030303030303631333030303051473EFA011500000008000005B52FB4AF695C30C082D578';

  const data = Buffer.from(hexString, 'hex');
  console.log(`[${new Date().toISOString()}] Enviando ${data.length} bytes: ${hexString}`);
  client.write(data);
});

// Cuando llegan datos del servidor
client.on('data', (chunk) => {
  const receivedHex = chunk.toString('hex').toUpperCase();
  console.log(`[${new Date().toISOString()}] Recibido ${chunk.length} bytes: ${receivedHex}`);
});

// Al cerrar la conexión
client.on('end', () => {
  console.log(`[${new Date().toISOString()}] Conexión terminada por el servidor`);
});

// Al ocurrir un error
client.on('error', (err) => {
  console.error(`[${new Date().toISOString()}] Error de conexión:`, err);
});

// Opcional: detectar cierre completo
client.on('close', (hadError) => {
  console.log(
    `[${new Date().toISOString()}] Conexión cerrada${hadError ? ' con error' : ''}`
  );
});
