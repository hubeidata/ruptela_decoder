import net from 'net';

// Configura host y puerto
const options = { port: 6000 };

console.log(`[${new Date().toISOString()}] Iniciando conexión a ${options.host}:${options.port}`);

const client = net.connect(options, () => {
  console.log(`[${new Date().toISOString()}] Conectado al servidor`);

  // Datos en hexadecimal
  const hexString = '03D7000311118FFC284144010C6812A421000000D555B793F643E2B064E05A1E0700060900090A000500001B0D00020001950101960100860000870000880001950101960104001D3016001E002E00890000008B0007010041048D9B3F006812A42F000000D555B430F643E03664DA154A0900070800090A000500001B0D00020001950101960100860000870000880001950101960104001D3016001E002E00890000008B000E010041048D9B4A006812A441000000D555B6ECF643E35664DA68920900050800090A000500001B0D00020001950101960100860000870000880001950101960104001D3014001E002D00890000008B0012010041048D9B4F006812A44F000000D555B473F643E32464EB10540800060900090A000500001B0D00020001950101960100860000870000880001950101960104001D3016001E002E00890000008B0000010041048D9B4F006812A456000000D555B624F643E49364F367200700050A00090A000500001B0D00020001950101960100860000870000880001950101960104001D3019001E002E00890000008B0007010041048D9B55006812A474000000D555B86CF643E5E0652120A80600050A00090A000500001B0D00020001950101960100860000870000880001950101960104001D301F001E002D00890000008B0000010041048D9B55006812A478000000D555B6FDF643E518652962E80400050100090A000500001B0D00020001950101960100860000870000880001950101960104001D3016001E002E00890000008B0000010041048D9B55006812A48A000000D555B57EF643E1E865231D1A0600050B00090A000500001B0D00020001950101960100860000870000880001950101960104001D3019001E002E00890000008B0012010041048D9B60006812A4C6000000D555B027F643DF4D629757A80800000900070A000500001B0D00020001950101960100860000870000880001950101960104001D3015001E002E00890000008B003C010041048D9B66006812A502000000D555B3ABF643DFE364C456F40700000A00070A000500001B0D00020001950101960100860000870000880001950101960104001D301A001E002D00890000008B0000010041048D9B66006812A53E000000D555B38AF643DF3C64BC56F40900000800070A000500001B0D00020001950101960100860000870000880001950101960104001D301A001E002E00890000008B0000010041048D9B66006812A57A000000D555B3FEF643E0FE64F335D40A00000700070A000500001B0D00020001950101960100860000870000880001950101960104001D301F001E002E00890000008B0000010041048D9B66003744';

  const data = Buffer.from(hexString, 'hex');
  console.log(`[${new Date().toISOString()}] Enviando ${data.length} bytes: ${hexString}`);
  client.write(data);
});

// Cuando llegan datos del servidor
client.on('data', (chunk) => {
  const receivedHex = chunk.toString('hex').toUpperCase();
  console.log(`[${new Date().toISOString()}] Recibido ${chunk.length} bytes: ${receivedHex}`);
});

// Al cerrar la conexión
client.on('end', () => {
  console.log(`[${new Date().toISOString()}] Conexión terminada por el servidor`);
});

// Al ocurrir un error
client.on('error', (err) => {
  console.error(`[${new Date().toISOString()}] Error de conexión:`, err);
});

// Opcional: detectar cierre completo
client.on('close', (hadError) => {
  console.log(
    `[${new Date().toISOString()}] Conexión cerrada${hadError ? ' con error' : ''}`
  );
});
